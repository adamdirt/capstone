/*
 * tof_lib.c
 *
 *  Created on: Nov 7, 2023
 *      Author: adam
 */

#include "tof_lib.h"

uint8_t init_tof(VL53L5CX_Configuration	*config){
	uint8_t status = VL53L5CX_STATUS_OK;
	status |= vl53l5cx_init(&Sensor1Cfg);
	HAL_Delay(1000);
	//@todo more initialization


	return status;
}


uint8_t get_n_samples(VL53L5CX_Configuration* config, VL53L5CX_ResultsData* results, uint8_t samples){
	uint8_t i;
	uint8_t status = VL53L5CX_STATUS_OK;
	uint8_t is_ready = 0;

	status |= vl53l5cx_start_ranging(&config);

	for (i = 0; i < samples; i++){
		while(is_ready == 0){ // poll ;)
			status |= vl53l5cx_check_data_ready(&config, &is_ready);
		}
		vl53l5cx_get_ranging_data(&config, &results);
	}

	status |= vl53l5cx_stop_ranging(&config);

	return status;
}
